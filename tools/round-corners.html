<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Round Corners</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #1a1a2e;
      color: #eee;
      min-height: 100vh;
      padding: 40px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }
    h1 { color: #4cc9f0; }
    .controls {
      display: flex;
      gap: 20px;
      align-items: center;
      flex-wrap: wrap;
      justify-content: center;
    }
    label {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    input[type="range"] { width: 150px; }
    input[type="file"] {
      padding: 8px;
      background: #16213e;
      border: 1px solid #4cc9f0;
      border-radius: 6px;
      color: #eee;
    }
    button {
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      background: #4cc9f0;
      color: #1a1a2e;
    }
    button:hover { filter: brightness(1.1); }
    #preview {
      max-width: 90vw;
      max-height: 60vh;
      border-radius: var(--radius, 12px);
    }
    #drop-zone {
      border: 3px dashed #4cc9f0;
      border-radius: 12px;
      padding: 60px 100px;
      text-align: center;
    }
    #drop-zone.drag-over { background: rgba(76, 201, 240, 0.1); }
    .hidden { display: none; }
    #dimensions { color: #888; font-size: 14px; }
  </style>
</head>
<body>
  <h1>Round Corners Tool</h1>

  <div class="controls">
    <input type="file" id="file-input" accept="image/*">
    <label>
      Radius: <span id="radius-value">12</span>px
      <input type="range" id="radius-slider" min="0" max="100" value="12">
    </label>
    <button id="export-btn" class="hidden">Export PNG</button>
  </div>

  <div id="dimensions"></div>

  <div id="drop-zone">
    <p>Drop an image here or use the file picker</p>
  </div>

  <img id="preview" class="hidden">

  <canvas id="canvas" class="hidden"></canvas>

  <script>
    const fileInput = document.getElementById('file-input');
    const dropZone = document.getElementById('drop-zone');
    const preview = document.getElementById('preview');
    const canvas = document.getElementById('canvas');
    const radiusSlider = document.getElementById('radius-slider');
    const radiusValue = document.getElementById('radius-value');
    const exportBtn = document.getElementById('export-btn');
    const dimensions = document.getElementById('dimensions');

    let originalImage = null;

    fileInput.addEventListener('change', (e) => loadImage(e.target.files[0]));

    dropZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropZone.classList.add('drag-over');
    });
    dropZone.addEventListener('dragleave', () => dropZone.classList.remove('drag-over'));
    dropZone.addEventListener('drop', (e) => {
      e.preventDefault();
      dropZone.classList.remove('drag-over');
      if (e.dataTransfer.files[0]) loadImage(e.dataTransfer.files[0]);
    });

    function loadImage(file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        const img = new Image();
        img.onload = () => {
          originalImage = img;
          preview.src = e.target.result;
          preview.classList.remove('hidden');
          dropZone.classList.add('hidden');
          exportBtn.classList.remove('hidden');
          dimensions.textContent = `${img.naturalWidth} Ã— ${img.naturalHeight}px`;
          updateRadius();
        };
        img.src = e.target.result;
      };
      reader.readAsDataURL(file);
    }

    radiusSlider.addEventListener('input', updateRadius);

    function updateRadius() {
      const r = radiusSlider.value;
      radiusValue.textContent = r;
      preview.style.setProperty('--radius', r + 'px');
    }

    exportBtn.addEventListener('click', () => {
      if (!originalImage) return;

      const w = originalImage.naturalWidth;
      const h = originalImage.naturalHeight;
      const r = parseInt(radiusSlider.value) * (w / preview.offsetWidth); // Scale radius

      canvas.width = w;
      canvas.height = h;
      const ctx = canvas.getContext('2d');

      // Draw rounded rectangle clip
      ctx.beginPath();
      ctx.moveTo(r, 0);
      ctx.lineTo(w - r, 0);
      ctx.quadraticCurveTo(w, 0, w, r);
      ctx.lineTo(w, h - r);
      ctx.quadraticCurveTo(w, h, w - r, h);
      ctx.lineTo(r, h);
      ctx.quadraticCurveTo(0, h, 0, h - r);
      ctx.lineTo(0, r);
      ctx.quadraticCurveTo(0, 0, r, 0);
      ctx.closePath();
      ctx.clip();

      // Draw image
      ctx.drawImage(originalImage, 0, 0);

      // Download
      const link = document.createElement('a');
      link.download = 'rounded-image.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    });
  </script>
</body>
</html>
